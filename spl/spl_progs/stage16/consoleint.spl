//save usersp

[PROCESS_TABLE +([SYSTEM_STATUS_TABLE +1]*16) +13]=SP;
// Setting SP to UArea Page number * 512 - 1
SP = [PROCESS_TABLE + ([SYSTEM_STATUS_TABLE + 1] * 16) + 11] * 512 - 1;

backup;

alias pid R1;
pid=[TERMINAL_STATUS_TABLE+1];

alias process_table_entry R2;

process_table_entry=PROCESS_TABLE+pid*16;

[process_table_entry +8]=P0;//buffer

multipush(R1,R2);
R2=pid;
R1=9;
call MOD_0;
multipop(R1,R2);


restore;

SP=[PROCESS_TABLE +([SYSTEM_STATUS_TABLE +1]*16) +13];
ireturn;

